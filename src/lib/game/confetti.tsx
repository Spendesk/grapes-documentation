import ReactCanvasConfetti from "react-canvas-confetti";

import confetti from "canvas-confetti";

function randomInRange(min: number, max: number) {
  return Math.random() * (max - min) + min;
}

export function Confetti() {
  return (
    <ReactCanvasConfetti
      onInit={() => {
        const grapes = confetti.shapeFromPath({
          path: "M25.56.13c7.119 3.319 18.325 13.553 6.201 27.936-5.08-1.995-13.432-10.375-6.2-27.936z M.13 26.91c4.82-6.2 17.29-14.849 28.615.171C25.67 31.59 15.641 37.868.13 26.911z M35.114 35.835l.003.004a1.783 1.783 0 0 0 3.017-1.896l-.004-.006-.008-.014-.03-.045-.105-.162c-.092-.14-.226-.34-.403-.593a48.85 48.85 0 0 0-1.564-2.117 66.443 66.443 0 0 0-6.14-6.818c-5.416-5.25-13.516-11.38-24.194-14.777a1.782 1.782 0 1 0-1.08 3.396c10 3.18 17.639 8.943 22.793 13.94a62.893 62.893 0 0 1 5.81 6.448c.646.83 1.13 1.502 1.449 1.961a26.099 26.099 0 0 1 .438.65l.018.029zm14.848-3.719c-6.165-2.244-9.344-9.06-7.1-15.225 2.244-6.165 9.06-9.344 15.225-7.1 6.165 2.244 9.344 9.06 7.1 15.225-2.244 6.165-9.06 9.344-15.225 7.1zM16.923 58.51c-6.165-2.243-9.344-9.06-7.1-15.224 2.244-6.165 9.06-9.344 15.226-7.1 6.164 2.244 9.343 9.06 7.1 15.225-2.245 6.165-9.061 9.344-15.226 7.1z M38.122 38.596c-6.165-2.243-9.344-9.06-7.1-15.225 2.244-6.165 9.06-9.343 15.225-7.1 6.165 2.244 9.344 9.061 7.1 15.226-2.244 6.165-9.06 9.343-15.225 7.1z M24.671 49.502c-6.164-2.243-9.343-9.06-7.1-15.225 2.245-6.165 9.061-9.343 15.226-7.1 6.165 2.245 9.343 9.061 7.1 15.226-2.244 6.165-9.06 9.343-15.226 7.1zm30.194-4.812c-6.165-2.243-9.343-9.06-7.1-15.224 2.244-6.165 9.06-9.344 15.226-7.1 6.165 2.244 9.343 9.06 7.1 15.225-2.244 6.165-9.061 9.343-15.226 7.1z M28.168 65.944c-6.165-2.243-9.344-9.06-7.1-15.225 2.244-6.165 9.06-9.343 15.225-7.1 6.165 2.244 9.344 9.061 7.1 15.226-2.244 6.165-9.06 9.343-15.225 7.1z M41.415 55.597c-6.165-2.244-9.343-9.06-7.1-15.226 2.244-6.164 9.061-9.343 15.226-7.1 6.165 2.245 9.343 9.061 7.1 15.226-2.244 6.165-9.06 9.343-15.226 7.1 M58.158 61.69c-6.165-2.243-9.343-9.06-7.1-15.224 2.245-6.165 9.061-9.344 15.226-7.1 6.165 2.244 9.343 9.06 7.1 15.225-2.244 6.165-9.06 9.344-15.226 7.1z M44.911 72.039c-6.165-2.244-9.343-9.06-7.1-15.226 2.245-6.164 9.061-9.343 15.226-7.1 6.165 2.245 9.343 9.061 7.1 15.226-2.244 6.165-9.06 9.343-15.226 7.1z M61.655 78.133c-6.165-2.244-9.343-9.06-7.1-15.225 2.244-6.165 9.06-9.344 15.226-7.1 6.164 2.244 9.343 9.06 7.1 15.225-2.245 6.165-9.061 9.344-15.226 7.1z",
        });

        const duration = 5 * 1000;
        const animationEnd = Date.now() + duration;
        const defaults = {
          startVelocity: 30,
          spread: 360,
          ticks: 60,
          zIndex: 0,
          colors: [
            "#5d21d2",
            "#d84d26",
            "#dfd3f6",
            "#f1c0b3",
            "#01799d",
            "#b3d7e2",
          ],
          shapes: [grapes],
          scalar: 5,
        };

        const interval: NodeJS.Timeout = setInterval(function () {
          const timeLeft = animationEnd - Date.now();

          if (timeLeft <= 0) {
            return clearInterval(interval);
          }

          const particleCount = 50 * (timeLeft / duration);
          confetti({
            ...defaults,
            particleCount,
            origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 },
          });
          confetti({
            ...defaults,
            particleCount,
            origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 },
          });
        }, 250);
      }}
      style={{
        position: "fixed",
        pointerEvents: "none",
        width: "100%",
        height: "100%",
        top: 0,
        left: 0,
      }}
    />
  );
}
