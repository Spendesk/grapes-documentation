import { Preview } from "@/components/preview/preview";
import { Demo } from "./demo";

## Import

- `Autocomplete`: The autocomplete component
- `AutocompleteNoOptions`: A helper component designed for case where no result are found.
- `DropdownItem`: A helper component designed to represent a complex item inside a list.

## Usage

<Preview>
  <Demo />
</Preview>

```tsx
const unfilteredOptions = [
  { key: "1", label: "Marketing" },
  { key: "2", label: "Legal" },
  { key: "3", label: "Office" },
  { key: "4", label: "Platform" },
  { key: "5", label: "Finance" },
  { key: "6", label: "Recruitment" },
  { key: "7", label: "Growth" },
  { key: "8", label: "Management" },
];
type Option = (typeof unfilteredOptions)[number];

const MyComponent = () => {
  const [options, setOptions] = useState(unfilteredOptions);
  const [selectedOption, setSelectedOption] = useState<Option>();
  return (
    <Autocomplete
      options={options}
      value={selectedOption}
      renderNoOptions={(rawValue) => (
        <AutocompleteNoOptions>
          There are no results for {rawValue}
        </AutocompleteNoOptions>
      )}
      onSearch={(value) => {
        if (!value) {
          setOptions(unfilteredOptions);
          return;
        }
        setOptions(
          unfilteredOptions.filter((option) =>
            option.label.toLowerCase().includes(value.toLowerCase())
          )
        );
      }}
      onSelect={setSelectedOption}
      placeholder="Search a cost center"
    />
  );
};
```

## Variant

Use the `inputVariant` props to control the visual style of the Autocomplete.
The Autocomplete comes with two visual styles: default (default) and magicGradient.

<Preview>
  <Demo inputVariant="magicGradient" />
</Preview>

```tsx
<Autocomplete inputVariant="magicGradient" {...otherProps} />
```

## Size

Use the `fit` props to control the size of the Autocomplete.

<Preview>
  <Demo fit="parent" />
</Preview>

```tsx
<Autocomplete fit="parent" {...otherProps} />
```

## Placement

Use the `placement` props to move the list of suggested options above or below the Autocomplete.

<Preview>
  <Demo placement="top-start" />
</Preview>

```tsx
<Autocomplete placement="top-start" {...otherProps} />
```

## Clear Button

Use the `showClearSelectionButton` props to display a button at the end of the field to clear the input.

<Preview>
  <Demo showClearSelectionButton defaultValueIndex={1} />
</Preview>

```tsx
<Autocomplete showClearSelectionButton {...otherProps} />
```

## Create unknow option

The Autocomplete component lets the user create a new option when no options matches his search.
Use the `onAddOption` and `renderAddOption` to add this behavior.

```tsx
<Autocomplete
  onAddOption={(newOptionLabel) => {
    // Create the new option
    const newOption = {
      key: `myNewKey`,
      label: newOptionLabel,
    };

    // Add it to the list of options
    setOptions((options) => {
      return options.concat(newOption);
    });

    // Return the created option
    return newOption;
  }}
  renderAddOption={(inputValue) => {
    return <DropdownItem label={<span>Create {inputValue}</span>} />;
  }}
  {...otherProps}
/>
```

## Customization

### Customized option

Use the `renderOption` props to customize how option are rendered.

<Preview>
  <Demo withCustomRenderOption />
</Preview>

```tsx
<Autocomplete
  renderOption={(option, state) => (
    <DropdownItem
      {...state}
      label={option.label}
      prefix={<Avatar size="s" text={option.label} variant="square" />}
    />
  )}
  {...otherProps}
/>
```

### Customized input

Use the `renderPrefix` props to customize the input.

<Preview>
  <Demo withCustomPrefix defaultValueIndex={1} />
</Preview>

```tsx
<Autocomplete
  renderPrefix={() => <Avatar size="s" text="Supplier" variant="square" />}
  {...otherProps}
/>
```
